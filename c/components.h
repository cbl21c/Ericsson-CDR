#ifndef __COMPONENTS__
#define __COMPONENTS__


#define MAX_LINE_LEN 256
#define MAX_FIELD_LEN 48


typedef unsigned char byte;

typedef enum {
    CONSTRUCTOR = 'C',
    PRIMITIVE   = 'P'
} asn1TagType;

typedef struct asn1Object asn1Object;
typedef union {
    char*       (*decode) (int, unsigned char*);
    asn1Object  **next;
} choice;

struct asn1Object {
    char        *name;
    asn1TagType type;
    // char*       (*decode) (int, unsigned char*);
    choice      ref;
};

typedef enum {
    ACCEPTABLECHANNELCODINGS = 0,
    ACCEPTANCEOFCALLWAITING,
    ACCOUNTCODE,
    ACMCHARGINGINDICATOR,
    AGEOFLOCATIONESTIMATE,
    AIURREQUESTED,
    ANMCHARGINGINDICATOR,
    AOCCURRENCYAMOUNTSENT,
    BEARERSERVICECODE,
    BLADEID,
    BSSMAPCAUSECODE,
    BUDDYBLADEINDICATOR,
    CALLATTEMPTINDICATOR,
    CALLATTEMPTSTATE,
    CALLEDDIRECTORYNUMBER,
    CALLEDPARTYMNPINFO,
    CALLEDPARTYNUMBER,
    CALLEDSUBSCRIBERIMEI,
    CALLEDSUBSCRIBERIMEISV,
    CALLEDSUBSCRIBERIMSI,
    CALLIDENTIFICATIONNUMBER,
    CALLINGPARTYNUMBER,
    CALLINGPARTYNUMBERSPECIALARRANGEMENTIND,
    CALLINGSUBSCRIBERIMEI,
    CALLINGSUBSCRIBERIMEISV,
    CALLINGSUBSCRIBERIMSI,
    CALLPOSITION,
    CAMELCALLINGPARTYNUMBER,
    CAMELDESTINATIONADDRESS,
    CAMELINITIATEDCALLFORWARDING,
    CAMELORIGINATINGADDRESS,
    CAMELSMSCADDRESS,
    CARRIERIDENTIFICATIONCODE,
    CARRIERINFORMATION,
    CARRIERINFORMATIONBACKWARD,
    CARRIERINFORMATIONFORWARD,
    CARRIERSELECTIONSUBSTITUTIONINFORMATION,
    CAUSECODE,
    CCBSCALLINDICATOR,
    CHANGEINITIATINGPARTY,
    CHANNELALLOCATIONPRIORITYLEVEL,
    CHANNELCODINGUSED,
    CHARGEABLEDURATION,
    CHARGEDCALLINGPARTYNUMBER,
    CHARGEDPARTY,
    CHARGEINFORMATION,
    CHARGENUMBER,
    CHARGEPARTYDISTRIBUTED,
    CHARGEPARTYSINGLE,
    CHARGINGCASE,
    CHARGINGUNITSADDITION,
    CONTRACTORNUMBER,
    CRIINDICATOR,
    CRITOMS,
    CUGINCOMINGACCESSUSED,
    CUGINDEX,
    CUGINTERLOCKCODE,
    CUGOUTGOINGACCESSINDICATOR,
    CUGOUTGOINGACCESSUSED,
    C7CHARGINGMESSAGE,
    C7FIRSTCHTMESSAGE,
    C7SECONDCHTMESSAGE,
    DATE,
    DATEFORSTARTOFCHARGE,
    DECIPHERINGKEYS,
    DEFAULTCALLHANDLING,
    DEFAULTCALLHANDLING2,
    DEFAULTSMSHANDLING,
    DELIVERYOFERRONEOUSSDU1,
    DELIVERYOFERRONEOUSSDU2,
    DELIVERYOFERRONEOUSSDU3,
    DESTINATIONADDRESS,
    DISCONNECTINGPARTY,
    DISCONNECTIONDATE,
    DISCONNECTIONDUETOSYSTEMRECOVERY,
    DISCONNECTIONTIME,
    DTMFUSED,
    EMERGENCYSERVICECATEGORY,
    EMLPPPRIORITYLEVEL,
    ENDTOENDACCESSDATAMAP,
    ENTRYPOICA,
    EOSINFO,
    EVENTCRITOMS,
    EXCHANGEIDENTITY,
    EXITPOICA,
    FAULTCODE,
    FIRSTASSIGNEDSPEECHCODERVERSION,
    FIRSTCALLEDLOCATIONINFORMATION,
    FIRSTCALLEDLOCATIONINFORMATIONEXTENSION,
    FIRSTCALLINGLOCATIONINFORMATION,
    FIRSTCALLINGLOCATIONINFORMATIONEXTENSION,
    FIRSTRADIOCHANNELUSED,
    FIRSTTARGETLOCATIONINFORMATION,
    FLEXIBLECOUNTER1,
    FLEXIBLECOUNTER2,
    FLEXIBLECOUNTER3,
    FLEXIBLECOUNTER4,
    FLEXIBLECOUNTER5,
    FLEXIBLECOUNTER6,
    FLEXIBLECOUNTER7,
    FLEXIBLECOUNTER8,
    FNURREQUESTED,
    FORLOPPDURINGOUTPUTINDICATOR,
    FORLOPPRELEASEDURINGCALL,
    FREEFORMATDATA,
    FREEFORMATDATA2,
    FREEFORMATDATAAPPENDINDICATOR,
    FREEFORMATDATAAPPENDINDICATOR2,
    FREQUENCYBANDSUPPORTED,
    GENERICCHARGINGDIGITS,
    GENERICCHARGINGNUMBERS,
    GLOBALCALLREFERENCE,
    GSMCALLREFERENCENUMBER,
    GSMSCFADDRESS,
    GSMSCFCONTROLOFAOC,
    GSMSCFINITIATEDCALLINDICATOR,
    GUARANTEEDBITRATE,
    HORIZONTALACCURACY,
    ICIORDERED,
    INCOMINGASSIGNEDROUTE,
    INCOMINGPCHARGINGVECTOR,
    INCOMINGROUTE,
    INCOMPLETECALLDATAINDICATOR,
    INCOMPLETECOMPOSITECDRINDICATOR,
    INMARKINGOFMS,
    INSERVICETRIGGER,
    INTEREXCHANGECARRIERINDICATOR,
    INTERMEDIATERATE,
    INTERNALCAUSEANDLOC,
    INTERNATIONALCALLINDICATOR,
    INTERREGIONHANDOVERINDICATOR,
    INTERRUPTIONTIME,
    INVOCATIONOFCALLHOLD,
    IUCODEC,
    LASTCALLEDLOCATIONINFORMATION,
    LASTCALLEDLOCATIONINFORMATIONEXTENSION,
    LASTCALLINGLOCATIONINFORMATION,
    LASTPARTIALOUTPUT,
    LCSCLIENTIDENTITY,
    LCSCLIENTTYPE,
    LCSDEFERREDEVENTTYPE,
    LEVELOFCAMELSERVICE,
    LOCATIONCODE,
    LOCATIONESTIMATE,
    MAXBITRATEDOWNLINK,
    MAXBITRATEUPLINK,
    MCASMSINDICATOR,
    MESSAGEREFERENCE,
    MESSAGETYPEINDICATOR,
    MISCELLANEOUSINFORMATION,
    MLCADDRESS,
    MMEIDENTITY,
    MMENAME,
    MOBILESTATIONROAMINGNUMBER,
    MOBILESTATIONROAMINGNUMBERINFO,
    MOBILESUBSCRIBERNUMBERFORHLRINTERROGATION,
    MOBILEUSERCLASS1,
    MOBILEUSERCLASS2,
    MSCADDRESS,
    MSCIDENTIFICATION,
    MSCNUMBER,
    MTRFINDICATOR,
    MULTIMEDIACALL,
    NETWORKCALLREFERENCE,
    NETWORKINITIATEDUSSDOPERATIONS,
    NETWORKPROVIDEDCALLINGPARTYNUMBER,
    NUMBEROFCHANNELSREQUESTED,
    NUMBEROFMETERPULSES,
    NUMBEROFSHORTMESSAGES,
    OPTIMALROUTINGINVOCATIONFAILED,
    OPTIMALROUTINGTYPE,
    ORIGINALCALLEDNUMBER,
    ORIGINATEDCODE,
    ORIGINATINGACCESSISDN,
    ORIGINATINGADDRESS,
    ORIGINATINGCARRIER,
    ORIGINATINGCHARGEAREA,
    ORIGINATINGLINEINFORMATION,
    ORIGINATINGLOCATIONNUMBER,
    ORIGINFORCHARGING,
    OUTGOINGASSIGNEDROUTE,
    OUTGOINGPCHARGINGVECTOR,
    OUTGOINGROUTE,
    OUTPUTFORSUBSCRIBER,
    OUTPUTTYPE,
    PARTIALOUTPUTRECNUM,
    PCHARGINGVECTORRELATED,
    POSITIONACCURACY,
    POSITIONINGDELIVERY,
    PRESENTATIONANDSCREENINGINDICATOR,
    RADIOCHANNELPROPERTY,
    RANAPCAUSECODE,
    RECORDSEQUENCENUMBER,
    REDIRECTINGDROPBACK,
    REDIRECTINGDROPBACKNUMBER,
    REDIRECTINGIMSI,
    REDIRECTINGNUMBER,
    REDIRECTINGSPN,
    REDIRECTIONCOUNTER,
    REGIONALSERVICEUSED,
    REGIONDEPENDENTCHARGINGORIGIN,
    RELATEDCALLNUMBER,
    REROUTEDTOSERVICECENTREADDRESS,
    REROUTINGINDICATOR,
    RESIDUALBITERRORRATIO1,
    RESIDUALBITERRORRATIO2,
    RESIDUALBITERRORRATIO3,
    RESPONSETIMECATEGORY,
    RESTARTDURINGCALL,
    RESTARTDURINGOUTPUTINDICATOR,
    RETRIEVALOFHELDCALL,
    RNCIDOFFIRSTRNC,
    RNCIDOFTARGETRNC,
    ROAMINGPRIORITYLEVEL,
    RTCDEFAULTSERVICEHANDLING,
    RTCFAILUREINDICATOR,
    RTCINDICATOR,
    RTCNOTINVOKEDREASON,
    RTCSESSIONID,
    SDUERRORRATIO1,
    SDUERRORRATIO2,
    SDUERRORRATIO3,
    SELECTEDCODEC,
    SERVEDSUBSCRIBERNUMBER,
    SERVICECENTREADDRESS,
    SERVICEFEATURECODE,
    SERVICESWITCHINGTYPE,
    SMSREFERENCENUMBER,
    SMSRESULT,
    SPEECHCODERPREFERENCELIST,
    SRVCCADDITIONALSESSIONINDICATOR,
    SRVCCALERTINGINDICATOR,
    SRVCCCALLHOLDINDICATOR,
    SRVCCCONFERENCEINDICATOR,
    SRVCCINDICATOR,
    SRVCCORIGINATINGPREALERTINGINDICATOR,
    SSCODE,
    SSFLEGID,
    SSFCHARGINGCASE,
    SSINVOCATIONNOTIFICATION,
    SSREQUEST,
    SUBSCRIBERSTATE,
    SUBSCRIPTIONTYPE,
    SWITCHIDENTITY,
    TAC,
    TARGETIMEI,
    TARGETIMEISV,
    TARGETIMSI,
    TARGETLOCATIONINFORMATION,
    TARGETMSISDN,
    TARIFFCLASS,
    TARIFFSWITCHIND,
    TDSCOUNTER,
    TELESERVICECODE,
    TERMINATINGACCESSISDN,
    TERMINATINGCARRIER,
    TERMINATINGCHARGEAREA,
    TERMINATINGLOCATIONNUMBER,
    TERMINATINGMOBILEUSERCLASS1,
    TERMINATINGMOBILEUSERCLASS2,
    TERMINATINGUSERCLASS,
    TIMEFOREVENT,
    TIMEFORSTARTOFCHARGE,
    TIMEFORSTOPOFCHARGE,
    TIMEFORTCSEIZURECALLED,
    TIMEFORTCSEIZURECALLING,
    TIMEFROMREGISTERSEIZURETOSTARTOFCHARGING,
    TRAFFICACTIVITYCODE,
    TRAFFICCLASS,
    TRAFFICISOLATIONINDICATOR,
    TRANSFERDELAY,
    TRANSLATEDNUMBER,
    TRANSPARENCYINDICATOR,
    TYPEOFCALLEDSUBSCRIBER,
    TYPEOFCALLINGSUBSCRIBER,
    TYPEOFLOCATIONREQUEST,
    TYPEOFSIGNALLING,
    UETIMEZONE,
    UNSUCCESSFULPOSITIONINGDATAREASON,
    USERCLASS,
    USERPROVIDEDCALLINGPARTYNUMBER,
    USERTERMINALPOSITION,
    USERTOUSERINFORMATION,
    USERTOUSERSERVICE1INFORMATION,
    USSDAPPLICATIONIDENTIFIER,
    USSDOPERATIONIDENTIFIER,
    USSDPROCEDURECODE,
    USSDSERVICECODE,
    VERTICALACCURACY,
    VERTICALCOORDINATEREQUEST,
    WPSCALLINDICATOR,
    /* these parameters are inside constructors */
    SERVICEKEY,
    USERRATE,
    ASYNCSYNCINDICATOR,
    UILAYER1PROTOCOL,
    TRIGGERDETECTIONPOINT,
    CO_LOCATED,
    POINTCODEANDSUBSYSTEMNUMBER,
    GLOBALTITLE,
    GLOBALTITLEANDSUBSYSTEMNUMBER
} primitiveType;


extern asn1Object *root[];

/* extern declarations for primitive decode functions */
/* this is needed by each of the CDR types */
extern char* _Enumerated(int index, int max, char **label);
extern char* _Integer(int, byte*);
extern char* _Null(int, byte*);
extern char* _String(int, byte*);
extern char* _TBCDString(int, byte*);
extern char* _CallPosition(int, byte*);
extern char* _ChargedParty(int, byte*);
extern char* _Date(int, byte*);
extern char* _DisconnectingParty(int, byte*);
extern char* _INMarkingOfMS(int, byte*);
extern char* _InternalCauseAndLoc(int, byte*);
extern char* _OriginatedCode(int, byte*);
extern char* _OutputForSubscriber(int, byte*);
extern char* _TAC(int, byte*);
extern char* _TariffSwitchInd(int, byte*);
extern char* _Time(int, byte*);

extern void initialiseCDRObjects(void);


#endif

